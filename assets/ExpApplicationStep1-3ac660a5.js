import{U as W}from"./UserService-4489cda2.js";import{d as X,r as S,O as Y,S as Z,A as q,T as Q,J as P,U as ee,e as te,V as se,B as ae,g as ne,W as oe,h as C,o as r,c as p,j as l,a as e,t as h,H as V,w as i,n as I,l as c,G as re,X as y,D as L,F as g,C as D,Y as le,p as ce,Z as ie,$ as me}from"./index-69085551.js";import{T as ue,A as pe}from"./formSchema-e3197880.js";import"./ProjectChargeType-415a59f1.js";var T=(s=>(s.NA="NA",s.STAGE_1="STAGE1",s.STAGE_2="STAGE2",s.STAGE_3="STAGE3",s.STAGE_4="STAGE4",s.STAGE_5="STAGE5",s.STAGE_6="STAGE6",s))(T||{});const j=T;(s=>{function d(){return["NA","STAGE1","STAGE2","STAGE3","STAGE4","STAGE5","STAGE6"]}s.getDrugScreenings=d;function f(a){switch(a){case"NA":return"不適用";case"STAGE1":return"stage 1. 篩選、鑑定及確認:生物標的、分子標靶新藥、新生醫材料、新檢測試劑";case"STAGE2":return"stage 2. 潛力標的物之合成及改良:新醫材/試劑之設計/改良";case"STAGE3":return"stage 3. 臨床檢體驗證、細胞及動物有效性評估";case"STAGE4":return"stage 4. 先導藥品及醫材之最適化; 新醫材/試劑產品雛型之開發及試製造";case"STAGE5":return"stage 5. 藥理藥動改良;劑型設計;毒理安全性試驗";case"STAGE6":return"stage 6. 試驗用藥物: 新醫材/試劑之申請";default:return""}}s.getChineseDescription=f;function B(a){switch(a){case"NA":return"不適用";case"STAGE1":return"stage 1. Identification & confirmation of biomarkers, new targets, drugs, bio-medical devices.";case"STAGE2":return"stage 2. Synthesis & improvement of targets. Design & modification of new medical devices.";case"STAGE3":return"stage 3. Validation with clinical samples. In vitro & in vivo efficacy evaluation.";case"STAGE4":return"stage 4. Optimization of leads & device models-Prototype development- Pilot-scale manufacturing.";case"STAGE5":return"stage 5. Improvement of PK, PD, & formulation- Animal toxicity and safety tests.";case"STAGE6":return"stage 6. IND/IDE applications.";default:return""}}s.getEnglishDescription=B})(T||(T={}));const de={class:"fw-bold py-3 mb-4"},_e={class:"row mb-3"},he=e("label",{for:"expDateStart",class:"col-sm-2 col-md-3 col-form-label red-star"},"已安排之實驗日期區間",-1),ve={class:"col-8"},Se={class:"d-flex flow-row gap-1"},fe={class:"row mb-3"},be=e("label",{for:"liaison",class:"col-sm-2 col-md-3 col-form-label red-star"},"TAC聯絡窗口/SD",-1),ye={class:"col-8"},ge=e("h5",{class:"mb-0"},"已選擇服務項目",-1),Te={class:"table-responsive"},Ae={class:"table table-striped"},Ee=e("thead",null,[e("tr",null,[e("th",null,"Number"),e("th",null,"Service item"),e("th",null,"Note"),e("th",null,"Sample amount"),e("th",null,"Comment")])],-1),xe={class:"input-group mb-3"},Ge=e("h5",{class:"mb-0 red-star"},"Survey for Drug Screening",-1),ke=e("span",{class:"fw-light"}," Is this experiment related to drug screening or development?",-1),we=e("h5",{class:"mb-0 red-star"},"Points for Attention",-1),Ce=e("ol",null,[e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/sampleprep_c.html",target:"_blank"},"血液、血清、組織及尿液/Blood, Serum, Tissue and Urine")]),e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/slide_c.html",target:"_blank"},"玻片掃描/Slide Scanning")]),e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/femur_c.html",target:"_blank"},"股骨製備/Femur Preparation")]),e("li",null,[e("a",{class:"link-primary",href:" https://tmc.sinica.edu.tw/animal_checkin_c_01.html",target:"_blank"},"動物房/Mouse Hotel ")])],-1),Ie={class:"form-check form-check-inline"},De={class:"form-check-label",for:"terms"},Be=e("div",{class:"mb-2 d-flex justify-content-between flex-row-reverse"},[e("button",{class:"btn btn-primary"},"確定申請")],-1),Pe=X({__name:"ExpApplicationStep1",props:{labType:{}},async setup(s){let d,f;const a=S(s.labType),R=ce(),_=Y(),z=Z(),N=q(),H=W.getInstance();Q(z);const o=S({items:[],labType:a.value}),A=()=>a.value==="TMC"?ue:pe,E=S(A());o.value=_.getCartByLabType(a.value);const U=S(o.value.items.map(t=>({code:t.code,name:t.name,note:t.note,expServiceItemUnits:t.expServiceItemUnits})));P(()=>{o.value=_.getCartByLabType(a.value),E.value=A(),U.value=o.value.items.map(t=>({code:t.code,name:t.name,note:t.note,expServiceItemUnits:t.expServiceItemUnits}))}),ee((t,v)=>{a.value=t.params.labType,o.value=_.getCartByLabType(a.value),E.value=A()});const{errors:x,handleSubmit:O}=te({initialValues:{expServiceItems:U.value}}),{fields:J}=se("expServiceItems"),b=S(""),K=([d,f]=ae(()=>H.fetchExpTeamMembers(o.value.labType).catch(t=>(b.value=t.message,[]))),d=await d,f(),d).map(t=>({id:t.id,name:t.title,value:t.id.toString()})),M=ne(()=>a.value==="TMC"),F=O((t,v)=>{try{E.value.validateSync(t,{abortEarly:!1}),N.processStep1(o.value.labType,t,"1").then(async m=>{try{_.reset(o.value.labType),await N.proceedToStep2(m)}catch(u){b.value=u.message}}).catch(m=>{b.value=m.message})}catch(m){m.inner.map(u=>{let G={[u.path]:u.message};v.setErrors(G)})}}),$=()=>{R.push("/main")};return P(()=>{_.isEmpty&&$()}),oe(()=>{_.isEmpty&&$()}),(t,v)=>{const m=C("AppFloatingMessage"),u=C("AppInputGroup"),G=C("AppSelect");return r(),p(g,null,[l(m,{message:b.value},null,8,["message"]),e("form",{onSubmit:v[0]||(v[0]=(...n)=>c(F)&&c(F)(...n))},[e("h4",de,h(o.value.labType)+"服務項目",1),M.value?(r(),V(y,{key:0,class:"mb-2"},{body:i(()=>[e("div",_e,[he,e("div",ve,[e("div",Se,[l(u,{label:"起",id:"expDateStart",type:"date",format:"yyyy-mm-dd",name:"expDateStart",class:I(c(x).expDateStart?"form-control is-invalid":"form-control")},null,8,["class"]),re("~ "),l(u,{label:"迄",id:"expDateEnd",type:"date",format:"yyyy-mm-dd",name:"expDateEnd",class:I(c(x).expDateEnd?"form-control is-invalid":"form-control")},null,8,["class"])])])]),e("div",fe,[be,e("div",ye,[l(G,{id:"liaison",name:"liaison",options:c(K),"default-option":!0},null,8,["options"])])])]),_:1})):L("",!0),l(y,{class:"mb-2"},{header:i(()=>[ge]),body:i(()=>[e("div",Te,[e("table",Ae,[Ee,e("tbody",null,[(r(!0),p(g,null,D(c(J),(n,k)=>(r(),p("tr",{key:n.key},[e("td",null,h(n.value.code),1),e("td",null,h(n.value.name),1),e("td",null,h(n.value.note),1),e("td",null,[(r(!0),p(g,null,D(n.value.expServiceItemUnits,w=>(r(),p("div",{key:w.index},[e("div",xe,h(w.amount)+" "+h(w.name),1)]))),128))]),e("td",null,[l(ie,{name:`expServiceItems[${k}].comment`},null,8,["name"])])]))),128))])])])]),_:1}),l(y,{class:"mb-2"},{header:i(()=>[Ge]),title:i(()=>[ke]),body:i(()=>[(r(!0),p(g,null,D(c(j).getDrugScreenings(),(n,k)=>(r(),p("div",{class:"form-check my-3",key:n},[l(me,{id:`stage${k}`,name:"drugScreening",label:c(j).getChineseDescription(n),"checked-value":n},null,8,["id","label","checked-value"])]))),128))]),_:1}),M.value?(r(),V(y,{key:1,class:"mb-2"},{header:i(()=>[we]),body:i(()=>[e("div",null,[Ce,e("div",Ie,[l(le,{id:"terms",name:"terms","checked-value":"agree"}),e("label",De,[e("span",{class:I(c(x).terms?"text-danger":"")}," 我已詳細閱讀注意事項 (I have read the notes for applicants)",2)])])])]),_:1})):L("",!0),Be],32)],64)}}});export{Pe as default};
