import{d as T,s as A,r as n,f as v,K as D,h as I,o as r,i as p,k as V,w as h,j as s,F as f,z,B as _,t as o,p as N,l as x,W as b,m as F}from"./index-c3923e02.js";const M=s("p",{class:"text-danger"},"餘額充足時才會進入此頁面",-1),U=s("h4",{class:"fw-bold py-3 mb-4"},"計畫餘額",-1),K=s("h5",{class:"mb-0"},"計畫餘額",-1),L={class:"vstack"},O={class:"p-2"},W=s("div",{class:"row"},[s("div",{class:"col-1 my-1"}),s("div",{class:"col-3 my-1"},[s("span",{class:"mx-2 fw-bold"},"TAC Project ID")]),s("div",{class:"col-3 my-1"},[s("span",{class:"mx-2 fw-bold"},"PI")]),s("div",{class:"col-3 my-1"},[s("span",{class:"mx-2 fw-bold"},"機構")]),s("div",{class:"col-2 my-1"},[s("span",{class:"mx-2 fw-bold"},"餘額")])],-1),$={class:"col-1 my-1"},q=["value"],G={class:"col-2 my-1"},H={class:"mx-2"},J={class:"col-4 my-1"},Q={class:"mx-2"},R={class:"col-3 my-1"},X={class:"mx-2"},Y={class:"col-2 my-1"},Z={class:"mx-2"},ss={class:"d-flex flex-row justify-content-end"},es={class:"p-0"},ts={class:"d-flex flex-column"},os={class:"p-2"},as=s("b",null,"實驗總費用",-1),cs={class:"badge text-bg-info"},ls=s("div",{class:"text-danger"}," (因會依可申請之服務單價計算來扣除餘額，故所需繳金額，最終以同意單上之金額為主) ",-1),ns=s("hr",null,null,-1),ds={class:"form-check"},is=s("label",{class:"form-check-label",for:"createProject"},[s("span",null,"是否需建立新計畫")],-1),rs={class:"mb-2 d-flex justify-content-between flex-row-reverse mt-2"},ps=["disabled"],us=T({__name:"ExpApplicationStep4",props:{id:{}},setup(y){const w=y,a=A(),u=n([]),d=n(0),{fetchTotalExpCaseAmounts:j,fetchProjectBalances:C,deductProjectBalances:k,projectBalanceDeductions:B}=a,c=n(!1),l=n(B),i=v(()=>l.value.reduce((m,t)=>m+t.balance,0)),P=v(()=>i.value===0&&c.value===!1),g=async()=>{await k(l.value).then(()=>{c.value?a.proceedToStep5():a.proceedToStep6()})};return D(async()=>{await a.loadExpCaseById(w.id).then(async()=>{u.value=await C(),d.value=await j()})}),(m,t)=>{const S=I("AppCard");return r(),p(f,null,[M,U,V(S,{class:"mt-2"},{header:h(()=>[K]),body:h(()=>[s("div",L,[s("div",O,[W,(r(!0),p(f,null,z(u.value,e=>(r(),p("div",{class:"row",key:e.tacProjectId},[s("div",$,[x(s("input",{type:"checkbox",class:"form-check-input",value:e,"onUpdate:modelValue":t[0]||(t[0]=E=>l.value=E)},null,8,q),[[b,l.value]])]),s("div",G,[s("span",H,o(e.tacProjectId),1)]),s("div",J,[s("span",Q,o(e.pi),1)]),s("div",R,[s("span",X,o(e.organization),1)]),s("div",Y,[s("span",Z,o(e.balance)+"元",1)])]))),128))]),s("div",ss,[s("div",es,[s("div",ts,[s("div",os,[as,_(": "),s("span",cs,o(d.value),1),_(" 元, 擬使用餘額約為(粗估): "),s("span",{class:N(["badge text-bg-success",{"text-bg-danger":d.value>i.value}])},o(i.value),3),_(" 元 ")])]),ls])]),ns,s("div",ds,[x(s("input",{id:"createProject",name:"createProject",type:"checkbox",class:"form-check-input","onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e)},null,512),[[b,c.value]]),is])])]),_:1}),s("div",rs,[s("button",{class:"btn btn-primary",onClick:g,disabled:P.value}," 下一步 ",8,ps),s("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=e=>F(a).proceedToStep3())},"回上一步")])],64)}}});export{us as default};
