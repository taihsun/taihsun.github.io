import{d as B,o as t,f as l,g as e,F as _,A as C,t as n,a as E,T as D,r as L,z as M,aW as Z,aX as G,e as m,h as d,w as k,C as F,j as c,D as f,a2 as R,B as N,aY as P,aZ as j,a_ as z}from"./index-088406c1.js";import{w as X,a as Y}from"./ExpCaseFormSchema-45925b6b.js";const q={class:"table-responsive"},H={class:"table table-bordered"},J=e("thead",{class:"table-dark"},[e("tr",null,[e("td",null,"LAB"),e("td",null,"Number"),e("td",null,"Service Item"),e("td",null,"完成日期"),e("td",null,"實驗人員")])],-1),K=B({__name:"CompletedEditZone",props:{list:{}},setup(S){return(b,A)=>(t(),l("div",q,[e("table",H,[J,e("tbody",null,[(t(!0),l(_,null,C(b.list,p=>(t(),l("tr",{key:p.code},[e("td",null,n(p.labType),1),e("td",null,n(p.code),1),e("td",null,n(p.name),1),e("td",null,n(p.completedDate),1),e("td",null,n(p.completer),1)]))),128))])])]))}}),O={id:"uploadedFileBlock",class:"table-responsive my-1"},Q={class:"table table-bordered caption-top"},x=e("caption",null," 已上傳檔案列表 ",-1),ee=e("thead",null,[e("tr",null,[e("td",null,"上傳日期"),e("td",null,"上傳人員"),e("td",null,"備註"),e("td",null,"檔案")])],-1),te={id:"uploadFileBlock"},le={class:"d-flex"},ne={class:"p-1"},oe={class:"p-1"},ae={class:"ms-auto p-2"},se=B({__name:"UploadResultFileEditZone",props:{id:{}},async setup(S){let b,A;const p=S,{handleSubmit:g,values:i}=E({}),{fields:r,push:a,remove:$}=D("files"),h=L([]);[b,A]=M(()=>Z(p.id).then(u=>{h.value=u})),await b,A();const v=g(async u=>{var o;((o=u.files)==null?void 0:o.length)>0&&await G(p.id,u.files).then(()=>{for(let s=0;r.value.length>0;)$(s)})});return(u,o)=>{const s=m("AppDownloadLink"),w=m("AppFileInput"),T=m("AppTextarea"),V=m("AppMinusButton"),U=m("AppPlusButton"),W=m("AppCard");return t(),l(_,null,[e("div",O,[e("table",Q,[x,ee,e("tbody",null,[(t(!0),l(_,null,C(h.value,(y,I)=>(t(),l("tr",{key:I},[e("td",null,n(y.uploadedDate),1),e("td",null,n(y.uploader),1),e("td",null,n(y.comment),1),e("td",null,[d(s,{name:y.resultFile.name,value:y.resultFile.value},null,8,["name","value"])])]))),128))])])]),d(W,null,{header:k(()=>[F(" 新增上傳檔案 ")]),body:k(()=>[e("div",te,[(t(!0),l(_,null,C(c(r),(y,I)=>(t(),l("div",{class:"input-group my-1",key:y.key},[d(w,{name:`files[${I}].file`},null,8,["name"]),d(T,{name:`files[${I}].comment`,id:"floatingTextarea",placeholder:"註解"},null,8,["name"])]))),128)),e("div",le,[e("div",ne,[c(r).length>1?(t(),f(V,{key:0,onClick:o[0]||(o[0]=R(y=>c($)(c(r).length-1),["prevent"]))})):N("",!0)]),e("div",oe,[d(U,{onClick:o[1]||(o[1]=R(y=>c(a)({}),["prevent"]))})]),e("div",ae,[e("button",{class:"btn btn-primary",onClick:o[2]||(o[2]=(...y)=>c(v)&&c(v)(...y))},"Upload...")])])])]),_:1})],64)}}}),ue={class:"table-responsive"},pe={class:"table table-bordered"},ie=e("thead",{class:"table-dark"},[e("tr",null,[e("td",null,"LAB"),e("td",null,"Number"),e("td",null,"Service Item"),e("td",null,"Complete Amount"),e("td",null,"Complete Comment"),e("td")])],-1),re={key:0},de={key:0},ce={class:"text-end"},me=B({__name:"WaitingToCompleteEditZone",props:{list:{}},setup(S){const b=S,{handleSubmit:A}=E({validationSchema:X,initialValues:{waitingToCompleteItems:b.list}}),{fields:p}=D("waitingToCompleteItems"),g=A(async i=>{await P(i.waitingToCompleteItems)});return(i,r)=>{const a=m("AppInputGroup"),$=m("AppInput"),h=m("AppCheckbox");return t(),l(_,null,[e("div",ue,[e("table",pe,[ie,e("tbody",null,[(t(!0),l(_,null,C(c(p),(v,u)=>(t(),l("tr",{key:v.value.code},[e("td",null,n(v.value.labType),1),e("td",null,n(v.value.code),1),e("td",null,n(v.value.name),1),e("td",null,[(t(!0),l(_,null,C(v.value.completeSampleAmounts,(o,s)=>(t(),l("div",{key:s},[i.list[u].complete?(t(),l("div",re,n(i.list[u].completeSampleAmounts[s].amount)+" "+n(i.list[u].completeSampleAmounts[s].name),1)):(t(),f(a,{key:1,name:`waitingToCompleteItems[${u}].completeSampleAmounts[${s}].amount`,label:o.name,type:"number",min:"0"},null,8,["name","label"]))]))),128))]),e("td",null,[i.list[u].complete?(t(),l("span",de,n(i.list[u].comment),1)):(t(),f($,{key:1,name:`waitingToCompleteItems[${u}].commnet`},null,8,["name"]))]),e("td",null,[i.list[u].complete?N("",!0):(t(),f(h,{key:0,id:"start",name:`waitingToCompleteItems[${u}].complete`,"checked-value":!0},null,8,["name"]))])]))),128))])])]),e("div",ce,[e("button",{class:"btn btn-primary",onClick:r[0]||(r[0]=(...v)=>c(g)&&c(g)(...v))},"完成")])],64)}}}),_e={class:"table-responsive"},ve={class:"table table-bordered"},be=e("thead",{class:"table-dark"},[e("tr",null,[e("td",null,"LAB"),e("td",null,"Number"),e("td",null,"Service Item"),e("td",null,"Fee(NTD)"),e("td",null,"Applied Amount"),e("td",null,"Comment"),e("td",null,"實驗人員"),e("td",null,"Received Sample Amount"),e("td",null,"Received Comment"),e("td")])],-1),he={key:0},ye={key:0},Ae={class:"text-end"},ke=B({__name:"WaitingToStartEditZone",props:{list:{}},setup(S){const b=S,{handleSubmit:A,values:p,errors:g}=E({validationSchema:Y,initialValues:{waitingToStartItems:b.list}}),{fields:i}=D("waitingToStartItems"),r=A(async a=>{await j(a.waitingToStartItems)});return(a,$)=>{const h=m("AppInputGroup"),v=m("AppInput"),u=m("AppCheckbox");return t(),l(_,null,[e("div",_e,[e("table",ve,[be,e("tbody",null,[(t(!0),l(_,null,C(c(i),(o,s)=>(t(),l("tr",{key:o.value.code},[e("td",null,n(o.value.labType),1),e("td",null,n(o.value.code),1),e("td",null,n(o.value.name),1),e("td",null,n(o.value.fee),1),e("td",null,[(t(!0),l(_,null,C(o.value.appliedAmounts,(w,T)=>(t(),l("span",{key:T},[e("div",null,n(w),1)]))),128))]),e("td",null,n(o.value.comment),1),e("td",null,[(t(!0),l(_,null,C(o.value.expMembers,w=>(t(),l("div",{key:w},n(w),1))),128))]),e("td",null,[(t(!0),l(_,null,C(o.value.receivedSampleAmounts,(w,T)=>(t(),l("div",{key:T},[a.list[s].start?(t(),l("div",he,n(a.list[s].receivedSampleAmounts[T].amount)+" "+n(a.list[s].receivedSampleAmounts[T].name),1)):(t(),f(h,{key:1,name:`waitingToStartItems[${s}].receivedSampleAmounts[${T}].amount`,label:w.name,type:"number",min:"0"},null,8,["name","label"]))]))),128))]),e("td",null,[a.list[s].start?(t(),l("span",ye,n(a.list[s].commnet),1)):(t(),f(v,{key:1,name:`waitingToStartItems[${s}].commnet`},null,8,["name"]))]),e("td",null,[a.list[s].start?N("",!0):(t(),f(u,{key:0,id:"start",name:`waitingToStartItems[${s}].start`,"checked-value":!0},null,8,["name"]))])]))),128))])])]),e("div",Ae,[e("button",{class:"btn btn-primary",onClick:$[0]||($[0]=(...o)=>c(r)&&c(r)(...o))},"開始")])],64)}}}),ge=B({__name:"ManageExpServiceItem",props:{id:{}},async setup(S){let b,A;const p=S,g=L([]),i=L([]),r=L([]);return[b,A]=M(()=>z(p.id).then(a=>{g.value=a.waitingToStartList,i.value=a.waitingToCompleteList,r.value=a.completedList}).catch(a=>{console.error(a)})),await b,A(),(a,$)=>{const h=m("AppCard");return t(),l(_,null,[d(h,{class:"my-1"},{header:k(()=>[F(" Waiting to Start ")]),body:k(()=>[d(ke,{list:g.value},null,8,["list"])]),_:1}),d(h,{class:"my-1"},{header:k(()=>[F(" Waiting to Complete ")]),body:k(()=>[d(me,{list:i.value},null,8,["list"])]),_:1}),d(h,{class:"my-1"},{header:k(()=>[F(" Completed ")]),body:k(()=>[d(K,{list:r.value},null,8,["list"])]),_:1}),d(h,{class:"my-1"},{header:k(()=>[F(" Upload Result File(s) ")]),body:k(()=>[d(se,{id:a.id},null,8,["id"])]),_:1})],64)}}});export{ge as default};
