import{d as F,r as f,b4 as D,B as N,e as V,h as l,o as m,c as v,H as T,D as g,a as e,l as r,j as t,w as j,G as L,F as O,p as E}from"./index-b61f44e7.js";import{I as G}from"./InstrumentService-d5e02f07.js";import{u as H}from"./FormSchemaStore-c769df41.js";import"./InstrumentApiImpl-14e5db4e.js";const R=e("h4",{class:"fw-bold py-3 mb-3"},"修改儀器",-1),q={class:"row"},z={class:"col-xxl"},J={class:"card"},K={class:"card-body"},P={class:"row mb-3"},Q=e("label",{for:"labType",class:"col-sm-3 col-form-label red-star"},"單位 ",-1),U={class:"col-sm-4"},W={class:"row mb-3"},X=e("label",{for:"no",class:"col-sm-3 col-form-label red-star"},"NO. ",-1),Y={class:"col-sm-4"},Z={class:"row mb-3"},$=e("label",{for:"name",class:"col-sm-3 col-form-label red-star"},"名稱 ",-1),ee={class:"col-sm-4"},se={class:"row mb-3"},te=e("label",{for:"officialServiceBeginDate",class:"col-sm-3 col-form-label"},"Official service begin date",-1),oe={class:"col-sm-4"},ae={class:"row mb-3"},ne=e("label",{for:"functionDescription",class:"col-sm-3 col-form-label red-star"},"Function description ",-1),ce={class:"col-sm-4"},le={class:"mt-2 d-flex justify-content-between flex-row-reverse"},re=e("button",{type:"submit",class:"btn btn-primary"},"修改",-1),ie={key:0,type:"button",class:"btn btn-danger mx-1","data-bs-toggle":"modal","data-bs-target":"#exampleModal"},de=e("div",{class:"modal-body"},"確定刪除?",-1),me=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1),he=F({__name:"InstrumentModification",props:{instrumentId:{}},async setup(y){let u,_;const p=y,i=G.getInstance(),w=E(),o=f(""),a=f(!1),I=D().map(s=>({id:s.id,name:s.name,value:s.id.toString()}));let d=null;const{instrumentModificationFormSchema:x}=H();[u,_]=N(()=>i.fetchInstrumentById(p.instrumentId).then(s=>{d=s.data})),await u,_();const{handleSubmit:S}=V({validationSchema:x,initialValues:d}),b=S(async s=>{i.updateInstrument(s).then(n=>{a.value=!0,o.value=n}).catch(n=>{a.value=!1,o.value="更新失敗"})}),B=()=>{i.deleteInstrumentById(p.instrumentId).then(s=>{a.value=!0,w.push({name:"InstrumentManagement",params:{message:s}})}).catch(s=>{a.value=!1,o.value="刪除失敗"})};return(s,n)=>{var h;const k=l("AppMessage"),M=l("AppSelect"),c=l("AppInput"),A=l("router-link");return m(),v(O,null,[R,o.value?(m(),T(k,{key:0,message:o.value,success:a.value},null,8,["message","success"])):g("",!0),e("div",q,[e("form",{onSubmit:n[0]||(n[0]=(...C)=>r(b)&&r(b)(...C))},[e("div",z,[e("div",J,[e("div",K,[e("div",P,[Q,e("div",U,[t(M,{options:r(I),name:"labType","show-error-message":!0},null,8,["options"])])]),e("div",W,[X,e("div",Y,[t(c,{name:"no","show-error-message":!0})])]),e("div",Z,[$,e("div",ee,[t(c,{name:"name","show-error-message":!0})])]),e("div",se,[te,e("div",oe,[t(c,{name:"officialServiceBeginDate",type:"date"})])]),e("div",ae,[ne,e("div",ce,[t(c,{name:"functionDescription","show-error-message":!0})])])])])]),e("div",le,[re,(h=r(d))!=null&&h.deletable?(m(),v("button",ie," 刪除 ")):g("",!0),t(A,{to:"/instrument/management",class:"btn btn-outline-secondary"},{default:j(()=>[L("回儀器管理")]),_:1})])],32),e("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",{class:"modal-dialog"},[e("div",{class:"modal-content"},[de,e("div",{class:"modal-footer"},[me,e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:B}," 確定 ")])])])])])],64)}}});export{he as default};
