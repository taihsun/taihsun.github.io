import{U as O}from"./UserService-3a6d22cb.js";import{d as Q,M as W,Q as X,y as Y,R as q,r as k,S as J,a as Z,T as ee,z as te,c as se,H as ae,U as ne,e as w,o,f as m,h as r,g as e,t as d,D as P,w as c,n as C,j as l,C as oe,V as v,B as V,F as g,A as D,W as re,l as le,X as ce,Y as ie}from"./index-aa4c4465.js";import{T as me,A as ue}from"./formSchema-8baa440b.js";import"./ProjectChargeType-415a59f1.js";var T=(s=>(s.NA="NA",s.STAGE_1="STAGE1",s.STAGE_2="STAGE2",s.STAGE_3="STAGE3",s.STAGE_4="STAGE4",s.STAGE_5="STAGE5",s.STAGE_6="STAGE6",s))(T||{});const $=T;(s=>{function u(){return["NA","STAGE1","STAGE2","STAGE3","STAGE4","STAGE5","STAGE6"]}s.getDrugScreenings=u;function b(h){switch(h){case"NA":return"不適用";case"STAGE1":return"stage 1. 篩選、鑑定及確認:生物標的、分子標靶新藥、新生醫材料、新檢測試劑";case"STAGE2":return"stage 2. 潛力標的物之合成及改良:新醫材/試劑之設計/改良";case"STAGE3":return"stage 3. 臨床檢體驗證、細胞及動物有效性評估";case"STAGE4":return"stage 4. 先導藥品及醫材之最適化; 新醫材/試劑產品雛型之開發及試製造";case"STAGE5":return"stage 5. 藥理藥動改良;劑型設計;毒理安全性試驗";case"STAGE6":return"stage 6. 試驗用藥物: 新醫材/試劑之申請";default:return""}}s.getChineseDescription=b;function _(h){switch(h){case"NA":return"不適用";case"STAGE1":return"stage 1. Identification & confirmation of biomarkers, new targets, drugs, bio-medical devices.";case"STAGE2":return"stage 2. Synthesis & improvement of targets. Design & modification of new medical devices.";case"STAGE3":return"stage 3. Validation with clinical samples. In vitro & in vivo efficacy evaluation.";case"STAGE4":return"stage 4. Optimization of leads & device models-Prototype development- Pilot-scale manufacturing.";case"STAGE5":return"stage 5. Improvement of PK, PD, & formulation- Animal toxicity and safety tests.";case"STAGE6":return"stage 6. IND/IDE applications.";default:return""}}s.getEnglishDescription=_})(T||(T={}));const pe={class:"fw-bold py-3 mb-4"},de={class:"row mb-3"},_e=e("label",{for:"expDateStart",class:"col-sm-2 col-md-3 col-form-label red-star"},"已安排之實驗日期區間",-1),he={class:"col-8"},fe={class:"d-flex flow-row gap-1"},Se={class:"row mb-3"},be=e("label",{for:"liaison",class:"col-sm-2 col-md-3 col-form-label red-star"},"TAC聯絡窗口/SD",-1),ye={class:"col-8"},ve=e("h5",{class:"mb-0"},"已選擇服務項目",-1),ge={class:"table-responsive"},Te={class:"table table-striped"},Ae=e("thead",null,[e("tr",null,[e("th",null,"Number"),e("th",null,"Service item"),e("th",null,"Note"),e("th",null,"Sample amount"),e("th",null,"Comment")])],-1),Ee={class:"input-group mb-3"},Ge=e("h5",{class:"mb-0 red-star"},"Survey for Drug Screening",-1),xe=e("span",{class:"fw-light"}," Is this experiment related to drug screening or development?",-1),ke=e("h5",{class:"mb-0 red-star"},"Points for Attention",-1),we=e("ol",null,[e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/sampleprep_c.html",target:"_blank"},"血液、血清、組織及尿液/Blood, Serum, Tissue and Urine")]),e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/slide_c.html",target:"_blank"},"玻片掃描/Slide Scanning")]),e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/femur_c.html",target:"_blank"},"股骨製備/Femur Preparation")]),e("li",null,[e("a",{class:"link-primary",href:" https://tmc.sinica.edu.tw/animal_checkin_c_01.html",target:"_blank"},"動物房/Mouse Hotel ")])],-1),Ce={class:"form-check form-check-inline"},De={class:"form-check-label",for:"terms"},Ie=e("div",{class:"mb-2 d-flex justify-content-between flex-row-reverse"},[e("button",{class:"btn btn-primary"},"確定申請")],-1),Pe=Q({__name:"ExpApplicationStep1",props:{labType:{}},async setup(s){let u,b;const _=s,h=le(),f=W(),R=X(),I=Y(),j=O.getInstance();q(R);const p=k(f.getCartByLabType(_.labType)),M=t=>t==="TMC"?me:ue,N=k(M(_.labType));J((t,S)=>{const n=t.params.labType;p.value=f.getCartByLabType(n),N.value=M(n)});const z=p.value.items.map(t=>({code:t.code,name:t.name,note:t.note,expServiceItemUnits:t.expServiceItemUnits})),{errors:A,handleSubmit:L}=Z({initialValues:{expServiceItems:z}}),{fields:H}=ee("expServiceItems"),y=k(""),K=([u,b]=te(()=>j.fetchExpTeamMembers(p.value.labType).catch(t=>(y.value=t.message,[]))),u=await u,b(),u).map(t=>({id:t.id,name:t.title,value:t.id.toString()})),B=se(()=>_.labType==="TMC"),U=L((t,S)=>{try{N.value.validateSync(t,{abortEarly:!1}),I.processStep1(p.value.labType,t,"1").then(async n=>{try{f.reset(p.value.labType),await I.proceedToStep2(n)}catch(i){y.value=i.message}}).catch(n=>{y.value=n.message})}catch(n){n.inner.map(i=>{let E={[i.path]:i.message};S.setErrors(E)})}}),F=()=>{h.push("/main")};return ae(()=>{f.isEmpty&&F()}),ne(()=>{f.isEmpty&&F()}),(t,S)=>{const n=w("AppFloatingMessage"),i=w("AppInputGroup"),E=w("AppSelect");return o(),m(g,null,[r(n,{message:y.value},null,8,["message"]),e("form",{onSubmit:S[0]||(S[0]=(...a)=>l(U)&&l(U)(...a))},[e("h4",pe,d(p.value.labType)+"服務項目",1),B.value?(o(),P(v,{key:0,class:"mb-2"},{body:c(()=>[e("div",de,[_e,e("div",he,[e("div",fe,[r(i,{label:"起",id:"expDateStart",type:"date",format:"yyyy-mm-dd",name:"expDateStart",class:C(l(A).expDateStart?"form-control is-invalid":"form-control")},null,8,["class"]),oe("~ "),r(i,{label:"迄",id:"expDateEnd",type:"date",format:"yyyy-mm-dd",name:"expDateEnd",class:C(l(A).expDateEnd?"form-control is-invalid":"form-control")},null,8,["class"])])])]),e("div",Se,[be,e("div",ye,[r(E,{id:"liaison",name:"liaison",options:l(K),"default-option":!0},null,8,["options"])])])]),_:1})):V("",!0),r(v,{class:"mb-2"},{header:c(()=>[ve]),body:c(()=>[e("div",ge,[e("table",Te,[Ae,e("tbody",null,[(o(!0),m(g,null,D(l(H),(a,G)=>(o(),m("tr",{key:a.key},[e("td",null,d(a.value.code),1),e("td",null,d(a.value.name),1),e("td",null,d(a.value.note),1),e("td",null,[(o(!0),m(g,null,D(a.value.expServiceItemUnits,x=>(o(),m("div",{key:x.index},[e("div",Ee,d(x.amount)+" "+d(x.name),1)]))),128))]),e("td",null,[r(ce,{name:`expServiceItems[${G}].comment`},null,8,["name"])])]))),128))])])])]),_:1}),r(v,{class:"mb-2"},{header:c(()=>[Ge]),title:c(()=>[xe]),body:c(()=>[(o(!0),m(g,null,D(l($).getDrugScreenings(),(a,G)=>(o(),m("div",{class:"form-check my-3",key:a},[r(ie,{id:`stage${G}`,name:"drugScreening",label:l($).getChineseDescription(a),"checked-value":a},null,8,["id","label","checked-value"])]))),128))]),_:1}),B.value?(o(),P(v,{key:1,class:"mb-2"},{header:c(()=>[ke]),body:c(()=>[e("div",null,[we,e("div",Ce,[r(re,{id:"terms",name:"terms","checked-value":"agree"}),e("label",De,[e("span",{class:C(l(A).terms?"text-danger":"")}," 我已詳細閱讀注意事項 (I have read the notes for applicants)",2)])])])]),_:1})):V("",!0),Ie],32)],64)}}});export{Pe as default};
