import{d as y,r as g,o as n,f as l,g as e,t as d,F as u,A as m,i as T,K as C,M as k,N as w,e as f,D as b,j as B,B as h,H as N,O as $,h as _,w as v,P as A}from"./index-cc3b5264.js";const I={class:"input-group mb-3"},E=["onUpdate:modelValue"],U={class:"input-group-text"},V=y({__name:"ServiceItemCategoryItem",props:{item:{}},emits:["addToCart"],setup(p){const i=p,s=g([]);i.item.expServiceItemUnits.forEach(t=>{s.value.push({id:t.id,amount:t.amount,name:t.name,index:t.index})});function o(){const t=[];return s.value.forEach(a=>{t.push({id:a.id,amount:a.amount,name:a.name,index:a.index})}),t}function c(){s.value.forEach(t=>{t.amount=0})}return(t,a)=>(n(),l("tr",null,[e("td",null,d(t.item.code),1),e("td",null,d(t.item.name),1),e("td",null,d(t.item.note),1),e("td",null,[(n(!0),l(u,null,m(s.value,r=>(n(),l("div",{key:r.index},[e("div",I,[T(e("input",{type:"number",min:"0",step:"1",class:"form-control","onUpdate:modelValue":S=>r.amount=S,onkeydown:"javascript: return ['Backspace','Delete','ArrowLeft','ArrowRight'].includes(event.code) ? true : !isNaN(Number(event.key)) && event.code!=='Space'"},null,8,E),[[C,r.amount]]),e("span",U,d(r.name),1)])]))),128))]),e("td",null,[e("button",{class:"btn btn-success",onClick:a[0]||(a[0]=r=>(t.$emit("addToCart",o()),c()))}," Add ")])]))}}),x={class:"accordion",id:"accordionPanelsStayOpenExample"},D={class:"accordion-item"},L={class:"accordion-header"},M=["data-bs-target"],O={class:"fw-bold"},R={class:"accordion-body"},j={key:0,class:"table-responsive"},F={class:"table table-striped"},P=e("thead",null,[e("tr",null,[e("th",null,"Number"),e("th",null,"Service item"),e("th",null,"Note"),e("th",null,"Sample amount"),e("th")])],-1),H=y({__name:"ServiceItemCategory",props:{category:{},labType:{}},setup(p){const i=k(),s="panelsStayOpen-collapse"+w();return(o,c)=>{const t=f("ServiceItemCategory",!0);return n(),l("div",x,[e("div",D,[e("h2",L,[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#"+s,"aria-expanded":"false","aria-controls":s},[e("span",O,d(o.category.category),1)],8,M)]),e("div",{id:s,class:"accordion-collapse collapse"},[e("div",R,[o.category.items?(n(),l("div",j,[e("table",F,[P,e("tbody",null,[(n(!0),l(u,null,m(o.category.items,a=>(n(),b(V,{key:a.code,item:a,onAddToCart:r=>B(i).addItems(r,a,o.labType)},null,8,["item","onAddToCart"]))),128))])])])):h("",!0),(n(!0),l(u,null,m(o.category.subCategories,a=>(n(),l("div",{class:"mb-2",key:a.category},[a.items?(n(),b(t,{key:0,category:a,labType:o.labType},null,8,["category","labType"])):h("",!0)]))),128))])])])])}}}),K=e("h4",{class:"fw-bold py-3 mb-4"},"選擇服務項目",-1),q={class:"mb-0"},G=y({__name:"ServiceItemSelection",props:{labType:{}},setup(p){const i=p,s=A.getInstance(),o=g([]);return N(async()=>{await s.fetchServiceItemsByLabType(i.labType).then(c=>{o.value=c})}),$(async()=>{await s.fetchServiceItemsByLabType(i.labType).then(c=>{o.value=c})}),(c,t)=>{const a=f("AppCard");return n(),l(u,null,[K,_(a,null,{header:v(()=>[e("h5",q,d(c.labType)+"服務項目",1)]),body:v(()=>[(n(!0),l(u,null,m(o.value,r=>(n(),l("div",{class:"mb-2",key:r.category},[_(H,{category:r,labType:c.labType},null,8,["category","labType"])]))),128))]),_:1})],64)}}});export{G as default};
