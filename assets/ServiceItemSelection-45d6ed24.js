import{d as y,r as g,o as n,f as l,g as e,t as d,F as u,x as m,i as T,E as C,G as k,H as w,e as f,B as b,j as B,y as h,D as I,I as $,h as _,w as v,J as N}from"./index-501cd1c4.js";const A={class:"input-group mb-3"},E=["onUpdate:modelValue"],x={class:"input-group-text"},U=y({__name:"ServiceItemCategoryItem",props:{item:{}},emits:["addToCart"],setup(p){const i=p,o=g([]);i.item.expServiceItemUnits.forEach(t=>{o.value.push({id:t.id,amount:t.amount,name:t.name,index:t.index})});function s(){const t=[];return o.value.forEach(a=>{t.push({id:a.id,amount:a.amount,name:a.name,index:a.index})}),t}function c(){o.value.forEach(t=>{t.amount=0})}return(t,a)=>(n(),l("tr",null,[e("td",null,d(t.item.code),1),e("td",null,d(t.item.name),1),e("td",null,d(t.item.note),1),e("td",null,[(n(!0),l(u,null,m(o.value,r=>(n(),l("div",{key:r.index},[e("div",A,[T(e("input",{type:"number",min:"0",step:"1",class:"form-control","onUpdate:modelValue":S=>r.amount=S,onkeydown:"javascript: return ['Backspace','Delete','ArrowLeft','ArrowRight'].includes(event.code) ? true : !isNaN(Number(event.key)) && event.code!=='Space'"},null,8,E),[[C,r.amount]]),e("span",x,d(r.name),1)])]))),128))]),e("td",null,[e("button",{class:"btn btn-success",onClick:a[0]||(a[0]=r=>(t.$emit("addToCart",s()),c()))}," Add ")])]))}}),V={class:"accordion",id:"accordionPanelsStayOpenExample"},D={class:"accordion-item"},L={class:"accordion-header"},R=["data-bs-target"],j={class:"fw-bold"},F={class:"accordion-body"},M={key:0,class:"table-responsive"},O={class:"table table-striped"},G=e("thead",null,[e("tr",null,[e("th",null,"Number"),e("th",null,"Service item"),e("th",null,"Note"),e("th",null,"Sample amount"),e("th")])],-1),H=y({__name:"ServiceItemCategory",props:{category:{},labType:{}},setup(p){const i=k(),o="panelsStayOpen-collapse"+w();return(s,c)=>{const t=f("ServiceItemCategory",!0);return n(),l("div",V,[e("div",D,[e("h2",L,[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#"+o,"aria-expanded":"false","aria-controls":o},[e("span",j,d(s.category.category),1)],8,R)]),e("div",{id:o,class:"accordion-collapse collapse"},[e("div",F,[s.category.items?(n(),l("div",M,[e("table",O,[G,e("tbody",null,[(n(!0),l(u,null,m(s.category.items,a=>(n(),b(U,{key:a.code,item:a,onAddToCart:r=>B(i).addItems(r,a,s.labType)},null,8,["item","onAddToCart"]))),128))])])])):h("",!0),(n(!0),l(u,null,m(s.category.subCategories,a=>(n(),l("div",{class:"mb-2",key:a.name},[a.items?(n(),b(t,{key:0,category:a,labType:s.labType},null,8,["category","labType"])):h("",!0)]))),128))])])])])}}}),J=e("h4",{class:"fw-bold py-3 mb-4"},"選擇服務項目",-1),P={class:"mb-0"},z=y({__name:"ServiceItemSelection",props:{labType:{}},setup(p){const i=p,o=N.getInstance(),s=g([]);return I(async()=>{await o.fetchServiceItemsByLabType(i.labType).then(c=>{s.value=c})}),$(async()=>{await o.fetchServiceItemsByLabType(i.labType).then(c=>{s.value=c})}),(c,t)=>{const a=f("AppCard");return n(),l(u,null,[J,_(a,null,{header:v(()=>[e("h5",P,d(c.labType)+"服務項目",1)]),body:v(()=>[(n(!0),l(u,null,m(s.value,r=>(n(),l("div",{class:"mb-2",key:r.category},[_(H,{category:r,labType:c.labType},null,8,["category","labType"])]))),128))]),_:1})],64)}}});export{z as default};
