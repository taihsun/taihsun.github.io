import{d as F,r as f,aZ as N,s as V,e as D,h as l,o as m,c as v,B as T,z as g,a as e,l as r,j as t,w as j,A as L,F as O,p as z}from"./index-8fed8339.js";import{I as E}from"./InstrumentService-b871267b.js";import{u as R}from"./FormSchemaStore-83c66384.js";import"./InstrumentApiImpl-695594c2.js";const Z=e("h4",{class:"fw-bold py-3 mb-3"},"修改儀器",-1),q={class:"row"},G={class:"col-xxl"},H={class:"card"},J={class:"card-body"},K={class:"row mb-3"},P=e("label",{for:"labType",class:"col-sm-3 col-form-label red-star"},"單位 ",-1),Q={class:"col-sm-4"},U={class:"row mb-3"},W=e("label",{for:"no",class:"col-sm-3 col-form-label red-star"},"NO. ",-1),X={class:"col-sm-4"},Y={class:"row mb-3"},$=e("label",{for:"name",class:"col-sm-3 col-form-label red-star"},"名稱 ",-1),ee={class:"col-sm-4"},se={class:"row mb-3"},te=e("label",{for:"officialServiceBeginDate",class:"col-sm-3 col-form-label"},"Official service begin date",-1),oe={class:"col-sm-4"},ae={class:"row mb-3"},ne=e("label",{for:"functionDescription",class:"col-sm-3 col-form-label red-star"},"Function description ",-1),ce={class:"col-sm-4"},le={class:"mt-2 d-flex justify-content-between flex-row-reverse"},re=e("button",{type:"submit",class:"btn btn-primary"},"修改",-1),ie={key:0,type:"button",class:"btn btn-danger mx-1","data-bs-toggle":"modal","data-bs-target":"#exampleModal"},de=e("div",{class:"modal-body"},"確定刪除?",-1),me=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1),he=F({__name:"InstrumentModification",props:{instrumentId:{}},async setup(y){let u,_;const p=y,i=E.getInstance(),w=z(),o=f(""),a=f(!1),I=N().map(s=>({id:s.id,name:s.name,value:s.id.toString()}));let d=null;const{instrumentModificationFormSchema:x}=R();[u,_]=V(()=>i.fetchInstrumentById(p.instrumentId).then(s=>{d=s.data})),await u,_();const{handleSubmit:S}=D({validationSchema:x,initialValues:d}),b=S(async s=>{i.updateInstrument(s).then(n=>{a.value=!0,o.value=n}).catch(n=>{a.value=!1,o.value="更新失敗"})}),B=()=>{i.deleteInstrumentById(p.instrumentId).then(s=>{a.value=!0,w.push({name:"InstrumentManagement",params:{message:s}})}).catch(s=>{a.value=!1,o.value="刪除失敗"})};return(s,n)=>{var h;const k=l("AppMessage"),A=l("AppSelect"),c=l("AppInput"),M=l("router-link");return m(),v(O,null,[Z,o.value?(m(),T(k,{key:0,message:o.value,success:a.value},null,8,["message","success"])):g("",!0),e("div",q,[e("form",{onSubmit:n[0]||(n[0]=(...C)=>r(b)&&r(b)(...C))},[e("div",G,[e("div",H,[e("div",J,[e("div",K,[P,e("div",Q,[t(A,{options:r(I),name:"labType","show-error-message":!0},null,8,["options"])])]),e("div",U,[W,e("div",X,[t(c,{name:"no","show-error-message":!0})])]),e("div",Y,[$,e("div",ee,[t(c,{name:"name","show-error-message":!0})])]),e("div",se,[te,e("div",oe,[t(c,{name:"officialServiceBeginDate",type:"date"})])]),e("div",ae,[ne,e("div",ce,[t(c,{name:"functionDescription","show-error-message":!0})])])])])]),e("div",le,[re,(h=r(d))!=null&&h.deletable?(m(),v("button",ie," 刪除 ")):g("",!0),t(M,{to:"/instrument/management",class:"btn btn-outline-secondary"},{default:j(()=>[L("回儀器管理")]),_:1})])],32),e("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",{class:"modal-dialog"},[e("div",{class:"modal-content"},[de,e("div",{class:"modal-footer"},[me,e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:B}," 確定 ")])])])])])],64)}}});export{he as default};
