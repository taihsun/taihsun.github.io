import{d as B,o as t,f as l,g as e,F as _,x as C,t as n,a as E,O as N,r as L,s as V,aR as W,aS as Z,e as m,h as d,w as k,z as F,j as c,B as f,Y as D,y as R,aT as P,aU as j,aV as z}from"./index-72e9df21.js";import{w as O,a as Y}from"./ExpCaseFormSchema-b938bd9d.js";const q={class:"table-responsive"},H={class:"table table-bordered"},J=e("thead",{class:"table-dark"},[e("tr",null,[e("td",null,"LAB"),e("td",null,"Number"),e("td",null,"Service Item"),e("td",null,"完成日期"),e("td",null,"實驗人員")])],-1),K=B({__name:"CompletedEditZone",props:{list:{}},setup(S){return(b,A)=>(t(),l("div",q,[e("table",H,[J,e("tbody",null,[(t(!0),l(_,null,C(b.list,p=>(t(),l("tr",{key:p.code},[e("td",null,n(p.labType),1),e("td",null,n(p.code),1),e("td",null,n(p.name),1),e("td",null,n(p.completedDate),1),e("td",null,n(p.completer),1)]))),128))])])]))}}),Q={id:"uploadedFileBlock",class:"table-responsive my-1"},X={class:"table table-bordered caption-top"},x=e("caption",null," 已上傳檔案列表 ",-1),ee=e("thead",null,[e("tr",null,[e("td",null,"上傳日期"),e("td",null,"上傳人員"),e("td",null,"備註"),e("td",null,"檔案")])],-1),te={id:"uploadFileBlock"},le={class:"d-flex"},ne={class:"p-1"},oe={class:"p-1"},se={class:"ms-auto p-2"},ae=B({__name:"UploadResultFileEditZone",props:{id:{}},async setup(S){let b,A;const p=S,{handleSubmit:g,values:i}=E({}),{fields:r,push:s,remove:$}=N("files"),h=L([]);[b,A]=V(()=>W(p.id).then(u=>{h.value=u})),await b,A();const v=g(async u=>{var o;((o=u.files)==null?void 0:o.length)>0&&await Z(p.id,u.files).then(()=>{for(let a=0;r.value.length>0;)$(a)})});return(u,o)=>{const a=m("AppDownloadLink"),w=m("AppFileInput"),T=m("AppTextarea"),M=m("AppMinusButton"),U=m("AppPlusButton"),G=m("AppCard");return t(),l(_,null,[e("div",Q,[e("table",X,[x,ee,e("tbody",null,[(t(!0),l(_,null,C(h.value,(y,I)=>(t(),l("tr",{key:I},[e("td",null,n(y.uploadedDate),1),e("td",null,n(y.uploader),1),e("td",null,n(y.comment),1),e("td",null,[d(a,{name:y.resultFile.name,value:y.resultFile.value},null,8,["name","value"])])]))),128))])])]),d(G,null,{header:k(()=>[F(" 新增上傳檔案 ")]),body:k(()=>[e("div",te,[(t(!0),l(_,null,C(c(r),(y,I)=>(t(),l("div",{class:"input-group my-1",key:y.key},[d(w,{name:`files[${I}].file`},null,8,["name"]),d(T,{name:`files[${I}].comment`,id:"floatingTextarea",placeholder:"註解"},null,8,["name"])]))),128)),e("div",le,[e("div",ne,[c(r).length>1?(t(),f(M,{key:0,onClick:o[0]||(o[0]=D(y=>c($)(c(r).length-1),["prevent"]))})):R("",!0)]),e("div",oe,[d(U,{onClick:o[1]||(o[1]=D(y=>c(s)({}),["prevent"]))})]),e("div",se,[e("button",{class:"btn btn-primary",onClick:o[2]||(o[2]=(...y)=>c(v)&&c(v)(...y))},"Upload...")])])])]),_:1})],64)}}}),ue={class:"table-responsive"},pe={class:"table table-bordered"},ie=e("thead",{class:"table-dark"},[e("tr",null,[e("td",null,"LAB"),e("td",null,"Number"),e("td",null,"Service Item"),e("td",null,"Complete Amount"),e("td",null,"Complete Comment"),e("td")])],-1),re={key:0},de={key:0},ce={class:"text-end"},me=B({__name:"WaitingToCompleteEditZone",props:{list:{}},setup(S){const b=S,{handleSubmit:A}=E({validationSchema:O,initialValues:{waitingToCompleteItems:b.list}}),{fields:p}=N("waitingToCompleteItems"),g=A(async i=>{await P(i.waitingToCompleteItems)});return(i,r)=>{const s=m("AppInputGroup"),$=m("AppInput"),h=m("AppCheckbox");return t(),l(_,null,[e("div",ue,[e("table",pe,[ie,e("tbody",null,[(t(!0),l(_,null,C(c(p),(v,u)=>(t(),l("tr",{key:v.value.code},[e("td",null,n(v.value.labType),1),e("td",null,n(v.value.code),1),e("td",null,n(v.value.name),1),e("td",null,[(t(!0),l(_,null,C(v.value.completeSampleAmounts,(o,a)=>(t(),l("div",{key:a},[i.list[u].complete?(t(),l("div",re,n(i.list[u].completeSampleAmounts[a].amount)+" "+n(i.list[u].completeSampleAmounts[a].name),1)):(t(),f(s,{key:1,name:`waitingToCompleteItems[${u}].completeSampleAmounts[${a}].amount`,label:o.name,type:"number",min:"0"},null,8,["name","label"]))]))),128))]),e("td",null,[i.list[u].complete?(t(),l("span",de,n(i.list[u].comment),1)):(t(),f($,{key:1,name:`waitingToCompleteItems[${u}].commnet`},null,8,["name"]))]),e("td",null,[i.list[u].complete?R("",!0):(t(),f(h,{key:0,id:"start",name:`waitingToCompleteItems[${u}].complete`,"checked-value":!0},null,8,["name"]))])]))),128))])])]),e("div",ce,[e("button",{class:"btn btn-primary",onClick:r[0]||(r[0]=(...v)=>c(g)&&c(g)(...v))},"完成")])],64)}}}),_e={class:"table-responsive"},ve={class:"table table-bordered"},be=e("thead",{class:"table-dark"},[e("tr",null,[e("td",null,"LAB"),e("td",null,"Number"),e("td",null,"Service Item"),e("td",null,"Fee(NTD)"),e("td",null,"Applied Amount"),e("td",null,"Comment"),e("td",null,"實驗人員"),e("td",null,"Received Sample Amount"),e("td",null,"Received Comment"),e("td")])],-1),he={key:0},ye={key:0},Ae={class:"text-end"},ke=B({__name:"WaitingToStartEditZone",props:{list:{}},setup(S){const b=S,{handleSubmit:A,values:p,errors:g}=E({validationSchema:Y,initialValues:{waitingToStartItems:b.list}}),{fields:i}=N("waitingToStartItems"),r=A(async s=>{await j(s.waitingToStartItems)});return(s,$)=>{const h=m("AppInputGroup"),v=m("AppInput"),u=m("AppCheckbox");return t(),l(_,null,[e("div",_e,[e("table",ve,[be,e("tbody",null,[(t(!0),l(_,null,C(c(i),(o,a)=>(t(),l("tr",{key:o.value.code},[e("td",null,n(o.value.labType),1),e("td",null,n(o.value.code),1),e("td",null,n(o.value.name),1),e("td",null,n(o.value.fee),1),e("td",null,[(t(!0),l(_,null,C(o.value.appliedAmounts,(w,T)=>(t(),l("span",{key:T},[e("div",null,n(w),1)]))),128))]),e("td",null,n(o.value.comment),1),e("td",null,[(t(!0),l(_,null,C(o.value.expMembers,w=>(t(),l("div",{key:w},n(w),1))),128))]),e("td",null,[(t(!0),l(_,null,C(o.value.receivedSampleAmounts,(w,T)=>(t(),l("div",{key:T},[s.list[a].start?(t(),l("div",he,n(s.list[a].receivedSampleAmounts[T].amount)+" "+n(s.list[a].receivedSampleAmounts[T].name),1)):(t(),f(h,{key:1,name:`waitingToStartItems[${a}].receivedSampleAmounts[${T}].amount`,label:w.name,type:"number",min:"0"},null,8,["name","label"]))]))),128))]),e("td",null,[s.list[a].start?(t(),l("span",ye,n(s.list[a].commnet),1)):(t(),f(v,{key:1,name:`waitingToStartItems[${a}].commnet`},null,8,["name"]))]),e("td",null,[s.list[a].start?R("",!0):(t(),f(u,{key:0,id:"start",name:`waitingToStartItems[${a}].start`,"checked-value":!0},null,8,["name"]))])]))),128))])])]),e("div",Ae,[e("button",{class:"btn btn-primary",onClick:$[0]||($[0]=(...o)=>c(r)&&c(r)(...o))},"開始")])],64)}}}),ge=B({__name:"ManageExpServiceItem",props:{id:{}},async setup(S){let b,A;const p=S,g=L([]),i=L([]),r=L([]);return[b,A]=V(()=>z(p.id).then(s=>{g.value=s.waitingToStartList,i.value=s.waitingToCompleteList,r.value=s.completedList}).catch(s=>{console.error(s)})),await b,A(),(s,$)=>{const h=m("AppCard");return t(),l(_,null,[d(h,{class:"my-1"},{header:k(()=>[F(" Waiting to Start ")]),body:k(()=>[d(ke,{list:g.value},null,8,["list"])]),_:1}),d(h,{class:"my-1"},{header:k(()=>[F(" Waiting to Complete ")]),body:k(()=>[d(me,{list:i.value},null,8,["list"])]),_:1}),d(h,{class:"my-1"},{header:k(()=>[F(" Completed ")]),body:k(()=>[d(K,{list:r.value},null,8,["list"])]),_:1}),d(h,{class:"my-1"},{header:k(()=>[F(" Upload Result File(s) ")]),body:k(()=>[d(ae,{id:s.id},null,8,["id"])]),_:1})],64)}}});export{ge as default};
