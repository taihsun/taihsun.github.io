import{U as O}from"./UserService-be113d4f.js";import{O as U}from"./OrganizationService-c98847ed.js";import{d as B,u as F,r as p,B as w,I as P,e as V,h as d,o as S,c as k,a as e,t as a,H as D,D as N,j as l,w as j,G as y,l as u,F as E}from"./index-b61f44e7.js";import{u as M}from"./FormSchemaStore-c769df41.js";import"./ProjectChargeType-415a59f1.js";const G={class:"fw-bold py-3 mb-4"},H={class:"row"},T={class:"mb-1 col-md-6"},q={for:"title",class:"form-label"},J={id:"title"},K={class:"mb-1 col-md-6"},L={for:"username",class:"form-label"},Q={id:"username"},R={class:"mb-1 col-md-12"},W={for:"address",class:"form-label red-star"},X={class:"mb-1 col-md-6"},Y={class:"form-label red-star",for:"phone"},Z={class:"mb-1 col-md-6"},ee={class:"form-label",for:"mobile"},se={class:"mb-1 col-md-6"},te={for:"organization",class:"form-label red-star"},ae={class:"mb-1 col-md-6"},oe={class:"form-label red-star",for:"department"},ne={class:"mb-2 d-flex justify-content-between flex-row-reverse"},re={type:"submit",class:"btn btn-primary me-2"},pe=B({__name:"UserProfile",async setup(le){let o,c;const _=O.getInstance(),A=U.getInstance(),{t:f}=F(),{userProfileFormSchema:$}=M(),r=p(""),i=p(!1),h=p([]);try{h.value=([o,c]=w(()=>A.fetchOrganizationsExcludingOther().then(s=>s.map(t=>({id:t.id,name:t.name,value:t.id})))),o=await o,c(),o)}catch{i.value=!1,r.value=f("message.fetchOrganizations.failure")}let b=P({});try{b=([o,c]=w(()=>_.fetchUserProfile()),o=await o,c(),o)}catch{i.value=!1,r.value=f("message.fetchUserProfile.failure")}const{values:v,handleSubmit:z}=V({initialValues:b,validationSchema:$}),g=z(s=>{_.updateUserProfile(s).then(t=>{i.value=!0,r.value=t==null?void 0:t.data}).catch(function(t){var m,n;i.value=((m=t.response)==null?void 0:m.status)===200,r.value=(n=t.response)==null?void 0:n.data})});return(s,t)=>{const m=d("AppMessage"),n=d("AppInput"),x=d("AppSelect"),C=d("AppCard");return S(),k(E,null,[e("h4",G,a(s.$t("text.profileDetails")),1),r.value?(S(),D(m,{key:0,message:r.value,success:i.value},null,8,["message","success"])):N("",!0),l(C,null,{body:j(()=>[e("form",{onSubmit:t[0]||(t[0]=(...I)=>u(g)&&u(g)(...I))},[e("div",H,[e("div",T,[e("label",q,a(s.$t("text.name")),1),y(": "),e("span",J,a(u(v).title),1)]),e("div",K,[e("label",L,a(s.$t("text.email")),1),y(": "),e("span",Q,a(u(v).username),1)]),e("div",R,[e("label",W,a(s.$t("text.address")),1),l(n,{name:"address","show-error-message":!0})]),e("div",X,[e("label",Y,a(s.$t("text.tel")),1),l(n,{name:"phone","show-error-message":!0})]),e("div",Z,[e("label",ee,a(s.$t("text.mobile")),1),l(n,{name:"mobile","show-error-message":!0})]),e("div",se,[e("label",te,a(s.$t("text.organization")),1),l(x,{name:"organization",options:h.value,defaultOption:!1,"show-error-message":!0},null,8,["options"])]),e("div",ae,[e("label",oe,a(s.$t("text.department")),1),l(n,{name:"department","show-error-message":!0})])]),e("div",ne,[e("button",re,a(s.$t("button.update")),1)])],32)]),_:1})],64)}}});export{pe as default};
