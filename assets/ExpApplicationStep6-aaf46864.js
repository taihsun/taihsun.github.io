import{g as I,S as B}from"./SampleCategory-297f54b4.js";import{_ as E,a as N}from"./ExpApplicationStep6NonLivingFormPreview.vue_vue_type_script_setup_true_lang-d26ea4ec.js";import{d as k,q as D,s as P,r as A,c as F,e as C,o as n,f as a,B as y,w as x,z as b,g as t,F as j,x as S,t as e,j as u,n as V,y as h,U as z,V as L,h as w,ae as T,af as M,ag as q}from"./index-501cd1c4.js";import{a as G}from"./ProjectSource-b760b0a5.js";import"./SelectedIhcCommissionedItemPanel-54c59095.js";import"./LocationService-d3f74d48.js";const O={class:"vstack"},R={class:"p-2"},U={class:"col-2 my-1"},W={class:"mx-2"},H={class:"col-2 my-1"},J={class:"mx-2"},K={class:"col-2 my-1"},Q={class:"mx-2"},X={class:"col-2 my-1"},Y={class:"mx-2"},Z={class:"d-flex flex-row justify-content-end"},tt={class:"p-2"},et={class:"d-flex flex-column"},st={class:"p-2"},ot=t("b",null,"實驗總費用",-1),nt={class:"badge text-bg-info"},lt={key:1,class:"table table-bordered caption-top"},at=t("caption",null," 計畫資訊 ",-1),ct=t("td",null,"計畫主持人帳號",-1),it=t("td",null,"計畫共同負責人帳號",-1),dt=t("td",null,"主要聯絡人帳號",-1),rt=t("td",null,"主要聯絡人電話",-1),pt=t("td",null,"計畫編號",-1),ut=t("td",null,"計畫名稱",-1),_t=t("td",null,"計畫核銷機構(收據抬頭)",-1),mt=t("td",null,"計畫所屬部門",-1),ht=t("td",null,"產學合作",-1),vt=t("td",null,"計畫經費來源",-1),ft=t("td",null,"計畫描述",-1),gt=t("td",null,"有無計畫執行期限",-1),bt=k({inheritAttrs:!1,__name:"ExpApplicationStep6ProjectBalanceDeduction",props:{id:{},projectBalanceDeductions:{default:()=>[]},project:{}},async setup(r){let p,_;const v=D(),c=r,o=c.id,f=([p,_]=P(()=>v.fetchTotalExpCaseAmounts(o)),p=await p,_(),p),i=A(c.projectBalanceDeductions),m=F(()=>i.value?i.value.reduce((s,g)=>s+g.balance,0):0);return(s,g)=>{const d=C("AppBlock");return n(),a("div",z(L(s.$attrs)),[s.projectBalanceDeductions.length!==0?(n(),y(d,{key:0,id:"balanceDeductionBlock",class:"my-1"},{header:x(()=>[b("餘額扣除計畫 ")]),content:x(()=>[t("div",O,[t("div",R,[(n(!0),a(j,null,S(s.projectBalanceDeductions,l=>(n(),a("div",{class:"row",key:l.tacProjectId},[t("div",U,[t("span",W,e(l.tacProjectId),1)]),t("div",H,[t("span",J,e(l.pi),1)]),t("div",K,[t("span",Q,e(l.organization),1)]),t("div",X,[t("span",Y,e(l.balance)+"元",1)])]))),128))])]),t("div",Z,[t("div",tt,[t("div",et,[t("div",st,[ot,b(": "),t("span",nt,e(u(f)),1),b(" 元, 扣除金額: "),t("span",{class:V(["badge text-bg-success",{"text-bg-danger":u(f)>m.value}])},e(m.value),3),b(" 元 ")])])])])]),_:1})):h("",!0),s.project?(n(),a("table",lt,[at,t("tbody",null,[t("tr",null,[ct,t("td",null,e(s.project.piEmail),1)]),t("tr",null,[it,t("td",null,e(s.project.coPiEmail),1)]),t("tr",null,[dt,t("td",null,e(s.project.contactEmail),1)]),t("tr",null,[rt,t("td",null,e(s.project.contactPhone),1)]),t("tr",null,[pt,t("td",null,e(s.project.code),1)]),t("tr",null,[ut,t("td",null,e(s.project.name),1)]),t("tr",null,[_t,t("td",null,e(s.project.organization),1)]),t("tr",null,[mt,t("td",null,e(s.project.department),1)]),t("tr",null,[ht,t("td",null,e(s.project.cooperate==="yes"?"是":"否"),1)]),t("tr",null,[vt,t("td",null,e(u(G)(s.project.projectSource)),1)]),t("tr",null,[ft,t("td",null,e(s.project.description),1)]),t("tr",null,[gt,t("td",null,e(s.project.deadline==="yes"?`${s.project.executionPeriodFrom} ~ ${s.project.executionPeriodTo}`:"無"),1)])])])):h("",!0)],16)}}}),$=r=>(T("data-v-c550c709"),r=r(),M(),r),yt=$(()=>t("h4",{class:"fw-bold py-3 mb-4"},"預覽",-1)),jt={class:"row"},$t={class:"mb-4 mb-xl-0"},Ct={class:"mt-3"},xt={class:"row"},St={class:"col-12 mb-3 mb-md-0"},Bt={class:"list-group list-group-horizontal-md"},wt=$(()=>t("a",{class:"list-group-item list-group-item-action active",id:"exp-service-item-list","data-bs-toggle":"list",href:"#exp-service-item"},"服務項目",-1)),kt={class:"list-group-item list-group-item-action",id:"application-form-list","data-bs-toggle":"list",href:"#application-form"},Dt=$(()=>t("a",{class:"list-group-item list-group-item-action",id:"deduction-list","data-bs-toggle":"list",href:"#deduction"},"扣款計畫",-1)),Pt={class:"col-12"},At={class:"tab-content p-0 font"},It={class:"tab-pane fade show active",id:"exp-service-item"},Et={class:"row"},Nt={class:"card"},Ft={class:"card-body"},Vt={class:"mb-4"},zt={class:"mb-4"},Lt={class:"table table-sm my-1"},Tt=$(()=>t("thead",null,[t("tr",null,[t("th",null,"Number"),t("th",null,"Service Items"),t("th",null,"Sample amount"),t("th",null,"Comment")])],-1)),Mt={class:"tab-pane fade",id:"application-form"},qt={class:"tab-pane fade",id:"deduction"},Gt={class:"mb-2 d-flex justify-content-between flex-row-reverse mt-2"},Ot=k({__name:"ExpApplicationStep6",props:{id:{}},async setup(r){let p,_;const v=r,c=D(),o=A();[p,_]=P(()=>c.loadDataForStep6(v.id).then(i=>{o.value=i}).catch(()=>{c.toMainWithMessage("資料載入失敗")})),await p,_();const f=async()=>{c.applyExpCaseApplication(v.id).then(i=>{c.toMainWithMessage(`實驗申請已送出，Service Request ID: ${i}`)})};return(i,m)=>{const s=C("AppCard"),g=C("AppConfirmButton");return n(),a(j,null,[yt,w(s,null,{body:x(()=>[t("div",jt,[t("div",$t,[t("div",Ct,[t("div",xt,[t("div",St,[t("div",Bt,[wt,t("a",kt,e(u(I)(o.value.sampleCategory))+"表單 ",1),Dt])]),t("div",Pt,[t("div",At,[t("div",It,[t("div",Et,[t("div",Nt,[t("div",Ft,[t("div",Vt," 已安排之實驗日期區間: "+e(o.value.expDateStart)+" ~ "+e(o.value.expDateEnd),1),t("div",zt,"TAC聯絡窗口/SD: "+e(o.value.liaison),1),t("table",Lt,[Tt,t("tbody",null,[(n(!0),a(j,null,S(o.value?.expServiceItems,d=>(n(),a("tr",{key:d.id},[t("td",null,e(d.code),1),t("td",null,e(d.name),1),t("td",null,[(n(!0),a(j,null,S(d.expServiceItemUnits,l=>(n(),a("span",{key:l.id},e(`${l.amount} (${l.name})`),1))),128))]),t("td",null,e(d.comment),1)]))),128))])])])])])]),t("div",Mt,[o.value?.sampleCategory===u(B).LIVING&&o.value.livingFormsPreview?(n(),y(E,{key:0,class:"font",livingForms:o.value.livingFormsPreview},null,8,["livingForms"])):h("",!0),o.value?.sampleCategory===u(B).NON_LIVING&&o.value.nonLivingFormPreview?(n(),y(N,{key:1,class:"font",form:o.value.nonLivingFormPreview},null,8,["form"])):h("",!0)]),t("div",qt,[o.value?.projectBalanceDeductions?(n(),y(bt,{key:0,class:"font",id:"props.id",projectBalanceDeductions:o.value?.projectBalanceDeductions,project:o.value?.deductionProject},null,8,["projectBalanceDeductions","project"])):h("",!0)])])])])])])])]),_:1}),t("div",Gt,[w(g,{text:"送出",handler:f}),t("button",{class:"btn btn-outline-secondary",onClick:m[0]||(m[0]=d=>u(c).proceedToStep4(i.id))}," 回上一步 ")])],64)}}});const Qt=q(Ot,[["__scopeId","data-v-c550c709"]]);export{Qt as default};
