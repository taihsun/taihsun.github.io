import{d as C,r as h,aZ as F,s as N,a as V,e as l,o as m,f,B as D,y as v,g as e,j as r,h as t,w as T,z as j,F as L,l as O}from"./index-501cd1c4.js";import{I as z}from"./InstrumentService-bcf3f27d.js";import{u as E}from"./FormSchemaStore-f2d56775.js";import"./InstrumentApi-8a0ec2a1.js";const R=e("h4",{class:"fw-bold py-3 mb-3"},"修改儀器",-1),Z={class:"row"},q={class:"col-xxl"},G={class:"card"},H={class:"card-body"},J={class:"row mb-3"},K=e("label",{for:"labType",class:"col-sm-3 col-form-label red-star"},"單位 ",-1),P={class:"col-sm-4"},Q={class:"row mb-3"},U=e("label",{for:"no",class:"col-sm-3 col-form-label red-star"},"NO. ",-1),W={class:"col-sm-4"},X={class:"row mb-3"},Y=e("label",{for:"name",class:"col-sm-3 col-form-label red-star"},"名稱 ",-1),$={class:"col-sm-4"},ee={class:"row mb-3"},se=e("label",{for:"officialServiceBeginDate",class:"col-sm-3 col-form-label"},"Official service begin date",-1),te={class:"col-sm-4"},oe={class:"row mb-3"},ae=e("label",{for:"functionDescription",class:"col-sm-3 col-form-label red-star"},"Function description ",-1),ne={class:"col-sm-4"},ce={class:"mt-2 d-flex justify-content-between flex-row-reverse"},le=e("button",{type:"submit",class:"btn btn-primary"},"修改",-1),re={key:0,type:"button",class:"btn btn-danger mx-1","data-bs-toggle":"modal","data-bs-target":"#exampleModal"},ie=e("div",{class:"modal-body"},"確定刪除?",-1),de=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1),be=C({__name:"InstrumentModification",props:{instrumentId:{}},async setup(g){let u,_;const p=g,i=z.getInstance(),y=O(),o=h(""),a=h(!1),w=F().map(s=>({id:s.id,name:s.name,value:s.id.toString()}));let d=null;const{instrumentModificationFormSchema:I}=E();[u,_]=N(()=>i.fetchInstrumentById(p.instrumentId).then(s=>{d=s.data})),await u,_();const{handleSubmit:x}=V({validationSchema:I,initialValues:d}),b=x(async s=>{i.updateInstrument(s).then(n=>{a.value=!0,o.value=n}).catch(n=>{a.value=!1,o.value="更新失敗"})}),S=()=>{i.deleteInstrumentById(p.instrumentId).then(s=>{a.value=!0,y.push({name:"InstrumentManagement",params:{message:s}})}).catch(s=>{a.value=!1,o.value="刪除失敗"})};return(s,n)=>{const B=l("AppMessage"),k=l("AppSelect"),c=l("AppInput"),M=l("router-link");return m(),f(L,null,[R,o.value?(m(),D(B,{key:0,message:o.value,success:a.value},null,8,["message","success"])):v("",!0),e("div",Z,[e("form",{onSubmit:n[0]||(n[0]=(...A)=>r(b)&&r(b)(...A))},[e("div",q,[e("div",G,[e("div",H,[e("div",J,[K,e("div",P,[t(k,{options:r(w),name:"labType","show-error-message":!0},null,8,["options"])])]),e("div",Q,[U,e("div",W,[t(c,{name:"no","show-error-message":!0})])]),e("div",X,[Y,e("div",$,[t(c,{name:"name","show-error-message":!0})])]),e("div",ee,[se,e("div",te,[t(c,{name:"officialServiceBeginDate",type:"date"})])]),e("div",oe,[ae,e("div",ne,[t(c,{name:"functionDescription","show-error-message":!0})])])])])]),e("div",ce,[le,r(d)?.deletable?(m(),f("button",re," 刪除 ")):v("",!0),t(M,{to:"/instrument/management",class:"btn btn-outline-secondary"},{default:T(()=>[j("回儀器管理")]),_:1})])],32),e("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",{class:"modal-dialog"},[e("div",{class:"modal-content"},[ie,e("div",{class:"modal-footer"},[de,e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:S}," 確定 ")])])])])])],64)}}});export{be as default};
