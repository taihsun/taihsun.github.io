import{U as Q}from"./UserService-26a869a2.js";import{d as W,M as X,Q as Y,y as q,R as J,r as k,S as Z,a as ee,T as te,z as se,c as ae,H as ne,U as oe,e as w,o,f as m,h as r,g as e,t as d,D as P,w as c,n as C,j as l,C as re,V as y,B as V,F as g,A as I,W as le,l as ce,X as ie,Y as me}from"./index-a622a1bc.js";import{T as ue,A as pe}from"./formSchema-7b1d3a15.js";import"./ProjectChargeType-415a59f1.js";var T=(s=>(s.NA="NA",s.STAGE_1="STAGE1",s.STAGE_2="STAGE2",s.STAGE_3="STAGE3",s.STAGE_4="STAGE4",s.STAGE_5="STAGE5",s.STAGE_6="STAGE6",s))(T||{});const $=T;(s=>{function u(){return["NA","STAGE1","STAGE2","STAGE3","STAGE4","STAGE5","STAGE6"]}s.getDrugScreenings=u;function b(h){switch(h){case"NA":return"不適用";case"STAGE1":return"stage 1. 篩選、鑑定及確認:生物標的、分子標靶新藥、新生醫材料、新檢測試劑";case"STAGE2":return"stage 2. 潛力標的物之合成及改良:新醫材/試劑之設計/改良";case"STAGE3":return"stage 3. 臨床檢體驗證、細胞及動物有效性評估";case"STAGE4":return"stage 4. 先導藥品及醫材之最適化; 新醫材/試劑產品雛型之開發及試製造";case"STAGE5":return"stage 5. 藥理藥動改良;劑型設計;毒理安全性試驗";case"STAGE6":return"stage 6. 試驗用藥物: 新醫材/試劑之申請";default:return""}}s.getChineseDescription=b;function _(h){switch(h){case"NA":return"不適用";case"STAGE1":return"stage 1. Identification & confirmation of biomarkers, new targets, drugs, bio-medical devices.";case"STAGE2":return"stage 2. Synthesis & improvement of targets. Design & modification of new medical devices.";case"STAGE3":return"stage 3. Validation with clinical samples. In vitro & in vivo efficacy evaluation.";case"STAGE4":return"stage 4. Optimization of leads & device models-Prototype development- Pilot-scale manufacturing.";case"STAGE5":return"stage 5. Improvement of PK, PD, & formulation- Animal toxicity and safety tests.";case"STAGE6":return"stage 6. IND/IDE applications.";default:return""}}s.getEnglishDescription=_})(T||(T={}));const de={class:"fw-bold py-3 mb-4"},_e={class:"row mb-3"},he=e("label",{for:"expDateStart",class:"col-sm-2 col-md-3 col-form-label red-star"},"已安排之實驗日期區間",-1),fe={class:"col-8"},Se={class:"d-flex flow-row gap-1"},be={class:"row mb-3"},ve=e("label",{for:"liaison",class:"col-sm-2 col-md-3 col-form-label red-star"},"TAC聯絡窗口/SD",-1),ye={class:"col-8"},ge=e("h5",{class:"mb-0"},"已選擇服務項目",-1),Te={class:"table-responsive"},Ae={class:"table table-striped"},Ee=e("thead",null,[e("tr",null,[e("th",null,"Number"),e("th",null,"Service item"),e("th",null,"Note"),e("th",null,"Sample amount"),e("th",null,"Comment")])],-1),Ge={class:"input-group mb-3"},xe=e("h5",{class:"mb-0 red-star"},"Survey for Drug Screening",-1),ke=e("span",{class:"fw-light"}," Is this experiment related to drug screening or development?",-1),we=e("h5",{class:"mb-0 red-star"},"Points for Attention",-1),Ce=e("ol",null,[e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/sampleprep_c.html",target:"_blank"},"血液、血清、組織及尿液/Blood, Serum, Tissue and Urine")]),e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/slide_c.html",target:"_blank"},"玻片掃描/Slide Scanning")]),e("li",null,[e("a",{class:"link-primary",href:"https://tmc.sinica.edu.tw/femur_c.html",target:"_blank"},"股骨製備/Femur Preparation")]),e("li",null,[e("a",{class:"link-primary",href:" https://tmc.sinica.edu.tw/animal_checkin_c_01.html",target:"_blank"},"動物房/Mouse Hotel ")])],-1),Ie={class:"form-check form-check-inline"},De={class:"form-check-label",for:"terms"},Me=e("div",{class:"mb-2 d-flex justify-content-between flex-row-reverse"},[e("button",{class:"btn btn-primary"},"確定申請")],-1),Ve=W({__name:"ExpApplicationStep1",props:{labType:{}},async setup(s){let u,b;const _=s,h=ce(),f=X(),R=Y(),D=q(),j=Q.getInstance(),{loggedInUser:z}=J(R),p=k(f.getCartByLabType(_.labType)),M=t=>t==="TMC"?ue:pe,N=k(M(_.labType));Z((t,S)=>{const n=t.params.labType;p.value=f.getCartByLabType(n),N.value=M(n)});const L=p.value.items.map(t=>({code:t.code,name:t.name,note:t.note,expServiceItemUnits:t.expServiceItemUnits})),{errors:A,handleSubmit:H}=ee({initialValues:{expServiceItems:L}}),{fields:K}=te("expServiceItems"),v=k(""),O=([u,b]=se(()=>j.fetchExpTeamMembers(p.value.labType).catch(t=>(v.value=t.message,[]))),u=await u,b(),u).map(t=>({id:t.id,name:t.title,value:t.id.toString()})),B=ae(()=>_.labType==="TMC"),U=H((t,S)=>{try{N.value.validateSync(t,{abortEarly:!1}),D.processStep1(p.value.labType,t,z.value.id).then(async n=>{try{f.reset(p.value.labType),await D.proceedToStep2(n)}catch(i){v.value=i.message}}).catch(n=>{v.value=n.message})}catch(n){n.inner.map(i=>{let E={[i.path]:i.message};S.setErrors(E)})}}),F=()=>{h.push("/main")};return ne(()=>{f.isEmpty&&F()}),oe(()=>{f.isEmpty&&F()}),(t,S)=>{const n=w("AppFloatingMessage"),i=w("AppInputGroup"),E=w("AppSelect");return o(),m(g,null,[r(n,{message:v.value},null,8,["message"]),e("form",{onSubmit:S[0]||(S[0]=(...a)=>l(U)&&l(U)(...a))},[e("h4",de,d(p.value.labType)+"服務項目",1),B.value?(o(),P(y,{key:0,class:"mb-2"},{body:c(()=>[e("div",_e,[he,e("div",fe,[e("div",Se,[r(i,{label:"起",id:"expDateStart",type:"date",format:"yyyy-mm-dd",name:"expDateStart",class:C(l(A).expDateStart?"form-control is-invalid":"form-control")},null,8,["class"]),re("~ "),r(i,{label:"迄",id:"expDateEnd",type:"date",format:"yyyy-mm-dd",name:"expDateEnd",class:C(l(A).expDateEnd?"form-control is-invalid":"form-control")},null,8,["class"])])])]),e("div",be,[ve,e("div",ye,[r(E,{id:"liaison",name:"liaison",options:l(O),"default-option":!0},null,8,["options"])])])]),_:1})):V("",!0),r(y,{class:"mb-2"},{header:c(()=>[ge]),body:c(()=>[e("div",Te,[e("table",Ae,[Ee,e("tbody",null,[(o(!0),m(g,null,I(l(K),(a,G)=>(o(),m("tr",{key:a.key},[e("td",null,d(a.value.code),1),e("td",null,d(a.value.name),1),e("td",null,d(a.value.note),1),e("td",null,[(o(!0),m(g,null,I(a.value.expServiceItemUnits,x=>(o(),m("div",{key:x.index},[e("div",Ge,d(x.amount)+" "+d(x.name),1)]))),128))]),e("td",null,[r(ie,{name:`expServiceItems[${G}].comment`},null,8,["name"])])]))),128))])])])]),_:1}),r(y,{class:"mb-2"},{header:c(()=>[xe]),title:c(()=>[ke]),body:c(()=>[(o(!0),m(g,null,I(l($).getDrugScreenings(),(a,G)=>(o(),m("div",{class:"form-check my-3",key:a},[r(me,{id:`stage${G}`,name:"drugScreening",label:l($).getChineseDescription(a),"checked-value":a},null,8,["id","label","checked-value"])]))),128))]),_:1}),B.value?(o(),P(y,{key:1,class:"mb-2"},{header:c(()=>[we]),body:c(()=>[e("div",null,[Ce,e("div",Ie,[r(le,{id:"terms",name:"terms","checked-value":"agree"}),e("label",De,[e("span",{class:C(l(A).terms?"text-danger":"")}," 我已詳細閱讀注意事項 (I have read the notes for applicants)",2)])])])]),_:1})):V("",!0),Me],32)],64)}}});export{Ve as default};
